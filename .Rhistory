#labs(title = "{frame_state}")+
transition_states(timestamp)
plot <- ggmap::ggmap(scooter_map) + ggplot(df, aes(x = longitude,y=latitude,group = id,color = timestamp)) +
geom_point()+
geom_text(aes(label=battery_level),hjust=0, vjust=0)+
#labs(title = "{frame_state}")+
transition_states(timestamp)
plot <- ggmap::ggmap(scooter_map) +
geom_point(df, aes(x = longitude,y=latitude,group = id,color = timestamp))+
geom_text(aes(label=battery_level),hjust=0, vjust=0)+
#labs(title = "{frame_state}")+
transition_states(timestamp)
plot <- ggmap::ggmap(scooter_map) +
geom_point(df, aes(x = longitude,y=latitude,group = id,color = timestamp))+
geom_text(aes(label=battery_level),hjust=0, vjust=0)+
#labs(title = "{frame_state}")+
transition_states(timestamp)
plot <- ggmap::ggmap(scooter_map) +
geom_point(data = df, mapping = aes(x = longitude,y=latitude,group = id,color = timestamp))+
geom_text(aes(label=battery_level),hjust=0, vjust=0)+
#labs(title = "{frame_state}")+
transition_states(timestamp)
# ease_aes("linear")
animate(plot, renderer = gifski_renderer(),fps = 5,width = 1000, height = 1000)
plot <- ggmap::ggmap(scooter_map) +
geom_point(data = df, mapping = aes(x = longitude,y=latitude,group = id,color = timestamp))+
geom_text(aes(label=battery_level),hjust=0, vjust=0)+
#labs(title = "{frame_state}")+
transition_states(timestamp)
# ease_aes("linear")
animate(plot, renderer = gifski_renderer(),fps = 5,width = 1000, height = 1000)
plot <- ggmap::ggmap(scooter_map)
plot
scooter_map <- ggmap::get_stamenmap(bbox = c(left = min(df$longitude),
bottom = min(df$latitude),
right = max(df$longitude),
top = max(df$latitude)),
zoom = 13,
maptype = "terrain-background")
plot <- ggmap::ggmap(scooter_map)
plot
?maptype
scooter_map <- ggmap::get_stamenmap(bbox = c(left = min(df$longitude),
bottom = min(df$latitude),
right = max(df$longitude),
top = max(df$latitude)),
zoom = 13,
maptype = "toner")
plot <- ggmap::ggmap(scooter_map)
plot
scooter_map <- ggmap::get_stamenmap(bbox = c(left = min(df$longitude),
bottom = min(df$latitude),
right = max(df$longitude),
top = max(df$latitude)),
zoom = 14,
maptype = "toner")
plot <- ggmap::ggmap(scooter_map)
plot
plot + geom_point(data = df, mapping = aes(x = longitude,y=latitude,group = id,color = timestamp))+
geom_text(aes(label=battery_level),hjust=0, vjust=0)+
#labs(title = "{frame_state}")+
transition_states(timestamp)
plot + ggplot(data = df, mapping = aes(x = longitude,y=latitude,group = id,color = timestamp)) + geom_point()+
geom_text(aes(label=battery_level),hjust=0, vjust=0)+
#labs(title = "{frame_state}")+
transition_states(timestamp)
ggplot(data = df, mapping = aes(x = longitude,y=latitude,group = id,color = timestamp)) + geom_point()+
geom_text(aes(label=battery_level),hjust=0, vjust=0)+
#labs(title = "{frame_state}")+
transition_states(timestamp)
library(ggmap)
plot <- ggmap(scooter_map)+
geom_point(data = df, mapping = aes(x = longitude,y=latitude,group = id,color = timestamp))+
geom_text(aes(label=battery_level),hjust=0, vjust=0)+
#labs(title = "{frame_state}")+
transition_states(timestamp)
# ease_aes("linear")
animate(plot, renderer = gifski_renderer(),fps = 5,width = 1000, height = 1000)
plot <- ggmap(scooter_map,data = df)+
geom_point(aes(x = longitude,y=latitude,group = id,color = timestamp))+
geom_text(aes(label=battery_level),hjust=0, vjust=0)+
#labs(title = "{frame_state}")+
transition_states(timestamp)
# ease_aes("linear")
animate(plot, renderer = gifski_renderer(),fps = 5,width = 1000, height = 1000)
plot <- ggmap(scooter_map)+
geom_point(df, aes(x = longitude,y=latitude,group = id,color = timestamp))+
geom_text(df,aes(label=battery_level),hjust=0, vjust=0)+
#labs(title = "{frame_state}")+
transition_states(timestamp)
# ease_aes("linear")
animate(plot, renderer = gifski_renderer(),fps = 5,width = 1000, height = 1000)
plot <- ggplot () + ggmap(scooter_map)+
geom_point(df, aes(x = longitude,y=latitude,group = id,color = timestamp))+
geom_text(df,aes(label=battery_level),hjust=0, vjust=0)+
#labs(title = "{frame_state}")+
transition_states(timestamp)
plot <- ggmap(scooter_map)+
geom_point(df, aes(x = longitude,y=latitude,group = id,color = timestamp))
plot <- ggmap(scooter_map)+
geom_point(df, mapping = aes(x = longitude,y=latitude,group = id,color = timestamp))
plot <- ggmap(scooter_map)+
geom_point(df, mapping = aes(x = longitude,y=latitude,group = id,color = timestamp))
plot
plot <- ggmap(scooter_map)+
geom_point(df, mapping = aes(x = longitude,y=latitude,group = id,color = timestamp))+
geom_text(df,mapping = aes(label=battery_level),hjust=0, vjust=0)+
#   #labs(title = "{frame_state}")+
#   transition_states(timestamp)
#  # ease_aes("linear")
# animate(plot, renderer = gifski_renderer(),fps = 5,width = 1000, height = 1000)
count <- ggplot(df %>% group_by(timestamp) %>% mutate(code_count = length(levels(factor(code)))), aes(x = timestamp,y = code_count))+
geom_col()
plot <- ggmap(scooter_map)+
geom_point(df, mapping = aes(x = longitude,y=latitude,group = id,color = timestamp))+
geom_text(df,mapping = aes(label=battery_level),hjust=0, vjust=0)+
#   #labs(title = "{frame_state}")+
#   transition_states(timestamp)
#  # ease_aes("linear")
# animate(plot, renderer = gifski_renderer(),fps = 5,width = 1000, height = 1000)
count <- ggplot(df %>% group_by(timestamp) %>% mutate(code_count = length(levels(factor(code)))), aes(x = timestamp,y = code_count))+
geom_col()
plot <- ggmap(scooter_map)+
geom_point(df, mapping = aes(x = longitude,y=latitude,group = id,color = timestamp))+
geom_text(df,mapping = aes(label=battery_level),hjust=0, vjust=0)
plto
plot
plot <- ggmap(scooter_map)+
geom_point(df, mapping = aes(x = longitude,y=latitude,group = id,color = timestamp))+
geom_text(df,mapping = aes(label=battery_level),hjust=0, vjust=0)
plot
plot <- ggplot(df)
plot <- ggplot(df)+
geom_point(mapping = aes(x = longitude,y=latitude,group = id,color = timestamp))+
geom_text(mapping = aes(label=battery_level),hjust=0, vjust=0)
plot
plot <- ggplot(df,aes(x = longitude,y=latitude,group = id,color = timestamp))+
geom_point()+
geom_text(aes(label=battery_level),hjust=0, vjust=0)
plot
plot + ggmap(scooter_map)
plot <- ggmap(scooter_map)+
geom_point(df,aes(x = longitude,y=latitude,group = id,color = timestamp))
plot <- ggmap(scooter_map)+
geom_point(df,mapping = aes(x = longitude,y=latitude,group = id,color = timestamp))
plot
plot <- ggmap(scooter_map)+
geom_point(df,mapping = aes(x = longitude,y=latitude,group = id,color = battery_level))
plot
plot <- ggmap(scooter_map)+
geom_point(df,mapping = aes(x = longitude,y=latitude,group = id,color = battery_level))
plot <- ggmap(scooter_map)+
geom_point(df,mapping = aes(x = longitude,y=latitude,group = id,color = battery_level))
plot <- ggmap(scooter_map)+
geom_point(df,mapping = aes(x = longitude,y=latitude,group = id,color = battery_level))
geom_text(mapping = aes(x = longitude,y=latitude,label=sub("..$","",code)),hjust=0, vjust=0)+
labs(title = "{frame_state}")+
transition_states(timestamp)
plot <- ggmap(scooter_map)+
geom_point(df,mapping = aes(x = longitude,y=latitude,group = id,color = battery_level))
plot <- ggmap(scooter_map)+
geom_point(df,mapping = aes(x = longitude,y=latitude,group = id,color = battery_level))+
geom_text(mapping = aes(x = longitude,y=latitude,label=sub("..$","",code)),hjust=0, vjust=0)+
labs(title = "{frame_state}")+
transition_time(Date) +
labs(title = paste("Day", "{round(frame_time,0)}")) +
shadow_wake(wake_length = 0.1)
animate(ggm, fps = 24, duration = 16)
plot <- ggmap(scooter_map)+
geom_point(df,mapping = aes(x = longitude,y=latitude,group = id,color = battery_level))
geom_text(mapping = aes(x = longitude,y=latitude,label=sub("..$","",code)),hjust=0, vjust=0)+
labs(title = "{frame_state}")+
transition_time(Date) +
labs(title = paste("Day", "{round(frame_time,0)}")) +
shadow_wake(wake_length = 0.1)
plot <- ggmap(scooter_map)+
geom_point(df,mapping = aes(x = longitude,y=latitude,group = id,color = battery_level))+
geom_text(mapping = aes(x = longitude,y=latitude,label=sub("..$","",code)),hjust=0, vjust=0)+
labs(title = "{frame_state}")+
transition_time(Date) +
labs(title = paste("Day", "{round(frame_time,0)}")) +
shadow_wake(wake_length = 0.1)
plot <- ggmap(scooter_map)+
geom_point(df,mapping = aes(x = longitude,y=latitude,group = id,color = battery_level))+
geom_text(mapping = aes(x = longitude,y=latitude,label=sub("..$","",code)),hjust=0, vjust=0)+
labs(title = "{frame_state}")+
transition_time(Date) +
labs(title = paste("Day", "{round(frame_time,0)}")) +
shadow_wake(wake_length = 0.1)
animate(plot,renderer = gifski_renderer(), fps = 24, duration = 16)
plot <- ggmap(scooter_map)+
geom_point(df,mapping = aes(x = longitude,y=latitude,group = id,color = battery_level))+
geom_text(mapping = aes(x = longitude,y=latitude,label=sub("..$","",code)),hjust=0, vjust=0)+
labs(title = "{frame_state}")+
transition_time(timestamp()) +
labs(title = paste("Time", "{round(frame_time,0)}")) +
shadow_wake(wake_length = 0.1)
animate(plot,renderer = gifski_renderer(), fps = 24, duration = 16)
##------ Fri Oct 01 21:44:01 2021 ------##
##------ Fri Oct 01 21:44:01 2021 ------##
##------ Fri Oct 01 21:44:01 2021 ------##
##------ Fri Oct 01 21:44:01 2021 ------##
##------ Fri Oct 01 21:44:01 2021 ------##
geom_point(df,mapping = aes(x = longitude,y=latitude,group = id,color = battery_level))+
plot <- ggmap(scooter_map)+
geom_point(df,mapping = aes(x = longitude,y=latitude,group = id,color = battery_level))+
geom_text(mapping = aes(x = longitude,y=latitude,label=sub("..$","",code)),hjust=0, vjust=0)+
labs(title = "{frame_state}")+
transition_time(timestamp) +
labs(title = paste("Time", "{round(frame_time,0)}")) +
shadow_wake(wake_length = 0.1)
animate(plot,renderer = gifski_renderer(), fps = 24, duration = 16)
##------ Fri Oct 01 21:44:21 2021 ------##
##------ Fri Oct 01 21:44:21 2021 ------##
##------ Fri Oct 01 21:44:21 2021 ------##
##------ Fri Oct 01 21:44:21 2021 ------##
##------ Fri Oct 01 21:44:21 2021 ------##
plot <- ggmap(scooter_map)+
geom_point(df,mapping = aes(x = longitude,y=latitude,group = id,color = battery_level))+
geom_text(mapping = aes(x = longitude,y=latitude,label=sub("..$","",code)),hjust=0, vjust=0)+
labs(title = "{frame_state}")+
transition_time(timestamp) +
labs(title = paste("Time", "{round(frame_time,0)}")) +
shadow_wake(wake_length = 0.1)
animate(plot,renderer = gifski_renderer(), fps = 24, duration = 16)
plot <- ggmap(scooter_map)+
geom_point(df,mapping = aes(x = longitude,y=latitude,group = id,color = battery_level))+
geom_text(df, mapping = aes(x = longitude,y=latitude,label=sub("..$","",code)),hjust=0, vjust=0)+
labs(title = "{frame_state}")+
transition_time(timestamp) +
labs(title = paste("Time", "{round(frame_time,0)}")) +
shadow_wake(wake_length = 0.1)
animate(plot,renderer = gifski_renderer(), fps = 24, duration = 16)
plot <- ggmap(scooter_map)+
geom_point(df,mapping = aes(x = longitude,y=latitude,group = id,color = battery_level))+
geom_text(df, mapping = aes(x = longitude,y=latitude,label=sub("..$","",code)),hjust=0, vjust=0)+
labs(title = "{frame_state}")+
transition_time(timestamp) +
labs(title = paste("Time", "{frame_time}"))
animate(plot,renderer = gifski_renderer(), fps = 5)
plot <- ggmap(scooter_map)+
geom_point(df,mapping = aes(x = longitude,y=latitude,group = id,color = battery_level))+
geom_text(df, mapping = aes(x = longitude,y=latitude,label=sub("..$","",code)),hjust=0, vjust=0)+
labs(title = "{frame_state}")+
transition_time(timestamp) +
labs(title = paste("Time", "{frame_time}"))
animate(plot,renderer = gifski_renderer(), fps = 1)
scooter_map <- get_stamenmap(bbox = c(left = min(df$longitude),
bottom = min(df$latitude),
right = max(df$longitude),
top = max(df$latitude)),
zoom = 14,
maptype = "toner")
plot <- ggmap(scooter_map)+
geom_point(df,mapping = aes(x = longitude,y=latitude,group = id,color = battery_level))+
geom_text(df, mapping = aes(x = longitude,y=latitude,label=sub("..$","",code)),hjust=0, vjust=0)+
labs(title = "{frame_state}")+
transition_state(timestamp) +
labs(title = paste("Time", "{frame_time}"))
plot <- ggmap(scooter_map)+
geom_point(df,mapping = aes(x = longitude,y=latitude,group = id,color = battery_level))+
geom_text(df, mapping = aes(x = longitude,y=latitude,label=sub("..$","",code)),hjust=0, vjust=0)+
labs(title = "{frame_state}")+
transition_states(timestamp) +
labs(title = paste("Time", "{frame_time}"))
animate(plot,renderer = gifski_renderer(), fps = 1)
warning()
animate(plot,renderer = gifski_renderer(), fps = 1)
warnings()
plot <- ggmap(scooter_map)+
geom_point(df,mapping = aes(x = longitude,y=latitude,group = id,color = battery_level))+
geom_text(df, mapping = aes(x = longitude,y=latitude,label=sub("..$","",code)),hjust=0, vjust=0)+
labs(title = "{frame_state}")+
transition_states(timestamp)
animate(plot,renderer = gifski_renderer(), fps = 1)
warnings()
plot <- ggmap(scooter_map)+
geom_point(df,mapping = aes(x = longitude,y=latitude,group = id,color = battery_level))+
geom_text(df, mapping = aes(x = longitude,y=latitude,label=sub("..$","",code)),hjust=0, vjust=0)+
labs(title = "{closest_state}")+
transition_states(timestamp)
animate(plot,renderer = gifski_renderer(), fps = 1)
plot <- ggmap(scooter_map)+
geom_point(df,mapping = aes(x = longitude,y=latitude,group = id,color = battery_level))+
geom_text(df, mapping = aes(x = longitude,y=latitude,label=sub("..$","",code)),hjust=0, vjust=0)+
labs(title = "{closest_state}")+
transition_states(timestamp)
animate(plot,renderer = gifski_renderer(), fps = 6)
filelist <- list.files("database",full.names = T,pattern = "*.json")
df_list <- lapply(filelist, function(file){
json <- read_json(file,simplifyVector = T)
df <- data.frame(json$birds)
df$latitude <- df$location$latitude
df$longitude <- df$location$longitude
df$location <- NULL
df$timestamp <- as.POSIXct(as.numeric(sub("\\.json","",sub("\\D*","",file))),origin = "1970-01-01 00:00:00")
df
})
df <- do.call(rbind,df_list)
plot <- ggmap(scooter_map)+
geom_point(df,mapping = aes(x = longitude,y=latitude,group = id,color = battery_level))+
geom_text(df, mapping = aes(x = longitude,y=latitude,label=sub("..$","",code)),hjust=0, vjust=0)+
labs(title = "{closest_state}")+
transition_states(timestamp)
animate(plot,renderer = gifski_renderer(), fps = 6)
View(df)
length(levels(factor(df$timestamp)))
6*273
plot <- ggmap(scooter_map)+
geom_point(df,mapping = aes(x = longitude,y=latitude,group = id,color = battery_level))+
geom_text(df, mapping = aes(x = longitude,y=latitude,label=sub("..$","",code)),hjust=0, vjust=0)+
labs(title = "{frame_time}")+
transition_time(timestamp)
animate(plot,renderer = gifski_renderer(), fps = 6,duration = 200)
warning()
warnign()
warnign()
plot <- ggmap(scooter_map)+
geom_point(df,mapping = aes(x = longitude,y=latitude,group = id,color = battery_level))+
# geom_text(df, mapping = aes(x = longitude,y=latitude,label=sub("..$","",code)),hjust=0, vjust=0)+
labs(title = "{frame_time}")+
transition_time(timestamp)
animate(plot,renderer = gifski_renderer(), fps = 20)
plot <- ggmap(scooter_map)+
geom_density_2d(df,mapping = aes(x = longitude,y=latitude,group = id,color = battery_level))+
# geom_text(df, mapping = aes(x = longitude,y=latitude,label=sub("..$","",code)),hjust=0, vjust=0)+
# labs(title = "{frame_time}")+
#   transition_time(timestamp)
# animate(plot,renderer = gifski_renderer(), fps = 20)
count <- ggplot(df %>% group_by(timestamp) %>% mutate(code_count = length(levels(factor(code)))), aes(x = timestamp,y = code_count))+
geom_col()
plot <- ggmap(scooter_map)+
geom_density_2d(df,mapping = aes(x = longitude,y=latitude,group = id,color = battery_level))
plot
plot <- ggmap(scooter_map)+
geom_density_2d(df,mapping = aes(x = longitude,y=latitude))
plot
plot <- ggmap(scooter_map)+
geom_density_2d(df,mapping = aes(x = longitude,y=latitude))+
# geom_text(df, mapping = aes(x = longitude,y=latitude,label=sub("..$","",code)),hjust=0, vjust=0)+
labs(title = "{frame_time}")+
transition_time(timestamp)
animate(plot,renderer = gifski_renderer(), fps = 20)
plot <- ggmap(scooter_map)+
geom_density_2d(df,mapping = aes(x = longitude,y=latitude))+
# geom_text(df, mapping = aes(x = longitude,y=latitude,label=sub("..$","",code)),hjust=0, vjust=0)+
labs(title = "{frame_time}")+
transition_time(timestamp)+
ease_aes("linear")
animate(plot,renderer = gifski_renderer(), fps = 20)
plot <- ggmap(scooter_map)+
geom_density_2d(df,mapping = aes(x = longitude,y=latitude))+
# geom_text(df, mapping = aes(x = longitude,y=latitude,label=sub("..$","",code)),hjust=0, vjust=0)+
labs(title = "{closest_state}")+
transition_states(timestamp)+
trans
plot <- ggmap(scooter_map)+
geom_density_2d(df,mapping = aes(x = longitude,y=latitude))+
# geom_text(df, mapping = aes(x = longitude,y=latitude,label=sub("..$","",code)),hjust=0, vjust=0)+
labs(title = "{closest_state}")+
transition_states(timestamp)+
ease_aes("linear")
animate(plot,renderer = gifski_renderer(), fps = 20)
plot <- ggmap(scooter_map)+
geom_density_2d(df,mapping = aes(x = longitude,y=latitude))+
# geom_text(df, mapping = aes(x = longitude,y=latitude,label=sub("..$","",code)),hjust=0, vjust=0)+
labs(title = "{closest_state}")+
transition_states(timestamp)
animate(plot,renderer = gifski_renderer(), fps = 20)
install.packages("transformr")
library(transformr)
plot <- ggmap(scooter_map)+
geom_density_2d(df,mapping = aes(x = longitude,y=latitude))+
# geom_text(df, mapping = aes(x = longitude,y=latitude,label=sub("..$","",code)),hjust=0, vjust=0)+
labs(title = "{closest_state}")+
transition_states(timestamp)
animate(plot,renderer = gifski_renderer(), fps = 20)
plot <- ggmap(scooter_map)+
geom_density_2d(df,mapping = aes(x = longitude,y=latitude))+
# geom_text(df, mapping = aes(x = longitude,y=latitude,label=sub("..$","",code)),hjust=0, vjust=0)+
labs(title = "{frame_time}")+
transition_time(timestamp)
animate(plot,renderer = gifski_renderer(), fps = 20)
plot <- ggmap(scooter_map)+
geom_density_2d(df,mapping = aes(x = longitude,y=latitude))+
geom_point(df, mapping = aes(x = longitude,y=latitude),hjust=0, vjust=0)+
labs(title = "{frame_time}")+
transition_time(timestamp)+
shadow_wake(wake_length = 0.1)
plot <- ggmap(scooter_map)+
geom_density_2d(df,mapping = aes(x = longitude,y=latitude))+
geom_point(df, mapping = aes(x = longitude,y=latitude))+
labs(title = "{frame_time}")+
transition_time(timestamp)+
shadow_wake(wake_length = 0.1)
animate(plot,renderer = gifski_renderer(), fps = 20)
## Battery level
count <- ggplot(df %>% group_by(timestamp) %>% mutate(code_count = length(levels(factor(code)))), aes(x = timestamp,y = code_count))+
geom_line()
count
ggplot(df %>% group_by(timestamp) %>% mutate(mean_battery_level = mean(battery_level)),aes(x = timestamp))+
geom_line(aes(y = battery_level,group = code))+
geom_line(aes(y = mean_battery_level,color ="MEAN"))
ggplot(df %>% group_by(timestamp) %>% mutate(mean_battery_level = mean(battery_level)),aes(x = timestamp))+
geom_smooth(aes(y = battery_level,group = code))+
geom_smooth(aes(y = mean_battery_level,color ="MEAN"))
ggplot(df %>% group_by(timestamp) %>% mutate(mean_battery_level = mean(battery_level)),aes(x = timestamp))+
geom_smooth(aes(y = battery_level,group = code,color = code))+
geom_smooth(aes(y = mean_battery_level,color ="MEAN"))
ggplot(df %>% group_by(timestamp) %>% mutate(mean_battery_level = mean(battery_level)),aes(x = timestamp))+
geom_smooth(aes(y = battery_level,group = code,color = code,show.legend = FALSE))+
geom_smooth(aes(y = mean_battery_level,color ="MEAN"))
ggplot(df %>% group_by(timestamp) %>% mutate(mean_battery_level = mean(battery_level)),aes(x = timestamp))+
geom_smooth(aes(y = battery_level,group = code,color = code),show.legend = FALSE)+
geom_smooth(aes(y = mean_battery_level,color ="MEAN"))
ggplot(df %>% group_by(timestamp) %>% mutate(mean_battery_level = mean(battery_level)),aes(x = timestamp))+
geom_smooth(aes(y = battery_level,group = code,color = code),show.legend = FALSE)+
geom_smooth(aes(y = mean_battery_level,color ="MEAN"))+
theme(legend.position = NULL)
ggplot(df %>% group_by(timestamp) %>% mutate(mean_battery_level = mean(battery_level)),aes(x = timestamp))+
geom_smooth(aes(y = battery_level,group = code,color = code))+
geom_smooth(aes(y = mean_battery_level,color ="MEAN"))+
theme(legend.position = "none")
ggplot(df %>% group_by(timestamp) %>% mutate(mean_battery_level = mean(battery_level)),aes(x = timestamp))+
geom_line(aes(y = battery_level,group = code,color = code))+
geom_line(aes(y = mean_battery_level,color ="MEAN"))+
theme(legend.position = "none")
ggplot(df %>% group_by(timestamp) %>% mutate(mean_battery_level = mean(battery_level)),aes(x = timestamp))+
geom_line(aes(y = battery_level,group = code,color = code))+
geom_line(aes(y = mean_battery_level,color ="MEAN"))
## Amount of scooters tracked
ggplot(df %>% group_by(timestamp) %>% mutate(code_count = length(levels(factor(code)))), aes(x = timestamp,y = code_count))+
geom_line()
library(ggplot2)
library(dplyr)
library(jsonlite)
library(gganimate)
library(ggmap)
library(transformr)
library(av)
getDistance <- function(lat1,lon1,lat2,lon2)
{
dist <- (6378.388 * acos(sin(lat2*0.01745) * sin(lat1*0.01745) + cos(lat2*0.01745) * cos(lat1*0.01745) * cos(lon1*0.01745 - lon2*0.01745))*1000)
return(ifelse(is.na(dist),0,dist))
}
filelist <- list.files("database",full.names = T,pattern = "*.json")
df_list <- lapply(filelist, function(file){
json <- read_json(file,simplifyVector = T)
df <- data.frame(json$birds)
df$latitude <- df$location$latitude
df$longitude <- df$location$longitude
df$location <- NULL
df$timestamp <- as.POSIXct(as.numeric(sub("\\.json","",sub("\\D*","",file))),origin = "1970-01-01 00:00:00")
df
})
df <- do.call(rbind,df_list)
#Filter scooters for simplicity
df <- df  %>% filter(grepl("F",code))
ggplot(df) +
geom_point(aes(x = timestamp,y = code,color = id))+
theme(label.position = "none")
ggplot(df) +
geom_point(aes(x = timestamp,y = code,color = id))+
theme(legend.position = "none")
filelist <- list.files("database",full.names = T,pattern = "*.json")
df_list <- lapply(filelist, function(file){
json <- read_json(file,simplifyVector = T)
df <- data.frame(json$birds)
df$latitude <- df$location$latitude
df$longitude <- df$location$longitude
df$location <- NULL
df$timestamp <- as.POSIXct(as.numeric(sub("\\.json","",sub("\\D*","",file))),origin = "1970-01-01 00:00:00")
df
})
df <- do.call(rbind,df_list)
## Active Scooters
ggplot(df,aes(x = timestamp))+
geom_point(aes(y=code,group = code,size = !is.na(bounty_id)))
## Amount of scooters tracked
ggplot(df %>% group_by(timestamp) %>% mutate(code_count = length(levels(factor(code)))), aes(x = timestamp,y = code_count))+
geom_line()
ggplot(df %>% group_by(timestamp) %>% mutate(mean_battery_level = mean(battery_level)),aes(x = timestamp))+
geom_line(aes(y = battery_level,group = code))+
geom_smooth(aes(y = mean_battery_level,color ="MEAN"))
## Travel distances
df <- df %>%
#filter(grepl("^FZ5",code)) %>%
group_by(timestamp) %>%
group_by(code) %>%
mutate(distance = getDistance(latitude,longitude,lag(latitude),lag(longitude)))
df <- df%>%
group_by(format(timestamp,"%F%H")) %>%
mutate(total_distance_per_hour = sum(distance))
ggplot(df,aes(x=timestamp,y=total_distance_per_hour))+
geom_line()
theme(legend.position = "none")
### calculating the mean position of a nest/group bay averaging all its members positions
### Then calculating the distance of a single scooter to its nest average position
### averaging all distances of scooters per nest to its nest average position
### calculating variance of distances of scooters per nest to its nest average position
## the average distance should be low for the assumption to be true
df <- df %>% group_by(timestamp,nest_id) %>%
mutate(nest_id_mean_latitude = mean(latitude),
nest_id_mean_longitude = mean(longitude)) %>%
group_by(code) %>%
mutate(distance_from_nest = getDistance(latitude,longitude,nest_id_mean_latitude,nest_id_mean_longitude))
df <- df %>% group_by(nest_id) %>%
mutate(distance_from_nest_mean = mean(distance_from_nest))
ggplot(df %>% filter(!is.na(nest_id))) +
geom_col(aes(x = 1,fill= nest_id, y = distance_from_nest_mean),position = "dodge",)
ggplot(df %>% filter(!is.na(nest_id))) +
geom_point(aes(y = distance_from_nest,x = code))
